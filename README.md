# HA-DongHang-Lottery

ë™í–‰ë³µê¶Œ(ë¡œë˜6/45, ì—°ê¸ˆë³µê¶Œ720+) ì •ë³´ë¥¼ Home Assistantì—ì„œ ì¡°íšŒ/êµ¬ë§¤í•  ìˆ˜ ìžˆëŠ” ì»¤ìŠ¤í…€ í†µí•©ìž…ë‹ˆë‹¤.

> ðŸš¨ **ì£¼ì˜**: ì‚¬ìš© ë¹ˆë„ì— ë”°ë¼ ë™í–‰ë³µê¶Œ ì„œë²„ë¡œë¶€í„° **IP ì°¨ë‹¨**ì„ ë°›ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì°¨ë‹¨ë˜ë©´ HAê°€ í¬í•¨ëœ ë„¤íŠ¸ì›Œí¬ë¡œëŠ” dhlottery.co.krì— ì ‘ì†í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í˜¹ì‹œë¼ë„ ì°¨ë‹¨ëœ ê²½ìš° [ë¦´ë ˆì´ ì„œë²„ ì„¤ì • ê°€ì´ë“œ](RELAY_GUIDE.md)ë¥¼ ì°¸ì¡°í•˜ì—¬ ìš°íšŒí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

---

## Features

- **ê³„ì • ì •ë³´ ì¡°íšŒ**
  - ì˜ˆì¹˜ê¸ˆ ìž”ì•¡, ë¯¸í™•ì¸ ê²Œìž„ ìˆ˜, ë¯¸ìˆ˜ë ¹ ë‹¹ì²¨ê¸ˆ
- **ë¡œë˜6/45 ê²°ê³¼ ì¡°íšŒ**
  - ìµœì‹  íšŒì°¨ ë‹¹ì²¨ë²ˆí˜¸, ë³´ë„ˆìŠ¤ ë²ˆí˜¸, 1ë“± ë‹¹ì²¨ê¸ˆ/ë‹¹ì²¨ìž ìˆ˜
  - 2ë“±/3ë“±/ì „ì²´ ë‹¹ì²¨ìž ìˆ˜, íŒë§¤ê¸ˆ
  - ë‚´ ë²ˆí˜¸ ë‹¹ì²¨ í™•ì¸
- **ì—°ê¸ˆë³µê¶Œ720+ ê²°ê³¼ ì¡°íšŒ**
  - ìµœì‹  íšŒì°¨ 1ë“± ë‹¹ì²¨ ì¡°/ë²ˆí˜¸, ë³´ë„ˆìŠ¤ ì¡°/ë²ˆí˜¸
  - 1ë“± ë‹¹ì²¨ê¸ˆ/ë‹¹ì²¨ìž ìˆ˜
  - ë‚´ ë²ˆí˜¸ ë‹¹ì²¨ í™•ì¸
- **ë‚´ ì£¼ë³€ ë‹¹ì²¨ íŒë§¤ì **
  - ìœ„ì¹˜ ì—”í‹°í‹° ê¸°ë°˜ ê°€ìž¥ ê°€ê¹Œìš´ ë‹¹ì²¨ íŒë§¤ì  ìžë™ ê²€ìƒ‰
  - ë¡œë˜6/45 / ì—°ê¸ˆë³µê¶Œ720+ ê°ê°ì˜ ë‹¹ì²¨ íŒë§¤ì  í‘œì‹œ
  - íŒë§¤ì ëª…, ì£¼ì†Œ, ì „í™”ë²ˆí˜¸, ê±°ë¦¬, ë‹¹ì²¨ì¢…ë¥˜/ë°©ì‹, íŒë§¤ ë³µê¶Œ ì¢…ë¥˜
  - ì˜¨ë¼ì¸ íŒë§¤ì  ìžë™ ì œì™¸ (ë¬¼ë¦¬ ë§¤ìž¥ë§Œ í‘œì‹œ)
- **ë³µê¶Œ êµ¬ë§¤** (ì£¼ì˜: ì‹¤ì œ ê²°ì œ)
  - ë¡œë˜6/45 ìžë™/ìˆ˜ë™ êµ¬ë§¤
  - ì—°ê¸ˆë³µê¶Œ720+ ìžë™ êµ¬ë§¤
- **ì„œë¹„ìŠ¤ í˜¸ì¶œ**
  - ë‹¹ì²¨ íŒë§¤ì  ì¡°íšŒ, ë³µê¶Œ íŒë§¤ì  ê²€ìƒ‰
  - êµ¬ë§¤ ë‚´ì—­ ì¡°íšŒ, ë‹¤ìŒ íšŒì°¨ ì •ë³´ ì¡°íšŒ
- **ë‚˜ë§Œì˜ ë²ˆí˜¸ ì €ìž¥/ê´€ë¦¬**
- **ìžë™ ì—…ë°ì´íŠ¸**
  - ë¡œë˜6/45: ë§¤ì£¼ í† ìš”ì¼ 21:10
  - ì—°ê¸ˆë³µê¶Œ720+: ë§¤ì£¼ ëª©ìš”ì¼ 19:30
  - ê²°ê³¼ ë¯¸ë°˜ì˜ ì‹œ 10ë¶„ ê°„ê²© ìžë™ ìž¬ì‹œë„
- **Anti-Bot Evasion**
  - User-Agent ë¡œí…Œì´ì…˜ (25ê°œ), Poisson ë¶„í¬ ë”œë ˆì´, ì„œí‚· ë¸Œë ˆì´ì»¤
- **ë¦´ë ˆì´ ì„œë²„ ìš°íšŒ** (IP ì°¨ë‹¨ ì‹œ)
  - Cloudflare Workerë¥¼ í†µí•œ ë¦´ë ˆì´ ì—°ê²° ì§€ì›

---

## Install (HACS)

[![Open your Home Assistant instance and show the HACS repository.](https://my.home-assistant.io/badges/hacs_repository.svg)](https://my.home-assistant.io/redirect/hacs_repository/?owner=1bobby-git&repository=HA-DongHang-Lottery&category=integration)

1. HACS â†’ Integrations â†’ ìš°ì¸¡ ìƒë‹¨ â‹® â†’ Custom repositories
2. Repository: `https://github.com/1bobby-git/HA-DongHang-Lottery`
3. Category: Integration
4. ì„¤ì¹˜ í›„ Home Assistant ìž¬ì‹œìž‘

---

## Setup

[![Open your Home Assistant instance and start setting up the integration.](https://my.home-assistant.io/badges/config_flow_start.svg)](https://my.home-assistant.io/redirect/config_flow_start/?domain=donghang_lottery)

1. ì„¤ì • â†’ ê¸°ê¸° ë° ì„œë¹„ìŠ¤ â†’ í†µí•© ì¶”ê°€ â†’ **ë™í–‰ë³µê¶Œ**
2. ë™í–‰ë³µê¶Œ ê³„ì • ì •ë³´ ìž…ë ¥ (ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸)
3. (ì„ íƒ) ìœ„ì¹˜ ì—”í‹°í‹° ì„¤ì • - ë‚´ ì£¼ë³€ ë‹¹ì²¨ íŒë§¤ì  ê¸°ëŠ¥ì— ì‚¬ìš©ë©ë‹ˆë‹¤
4. **IP ì°¨ë‹¨ ìš°íšŒê°€ í•„ìš”í•œ ê²½ìš°**: "IP ì°¨ë‹¨ ìš°íšŒ (ë¦´ë ˆì´ ì„œë²„ ì‚¬ìš©)" ì²´í¬
5. ì²´í¬í•œ ê²½ìš° ë‹¤ìŒ í™”ë©´ì—ì„œ ë¦´ë ˆì´ ì„œë²„ URL ìž…ë ¥
6. ì™„ë£Œ

### ì¼ë°˜ ì‚¬ìš©ìž (ì°¨ë‹¨ë˜ì§€ ì•Šì€ ê²½ìš°)
ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸ë§Œ ìž…ë ¥í•˜ë©´ ë°”ë¡œ ì„¤ì •ì´ ì™„ë£Œë©ë‹ˆë‹¤.

### ì°¨ë‹¨ëœ ì‚¬ìš©ìž (ë¦´ë ˆì´ ì„œë²„ ì‚¬ìš©)
1. Cloudflare Worker ë°°í¬ (ì•„ëž˜ "ë¦´ë ˆì´ ì„œë²„ ì„¤ì •" ì°¸ì¡°)
2. ì„¤ì • ì‹œ "IP ì°¨ë‹¨ ìš°íšŒ" ì²´í¬
3. ë‹¤ìŒ í™”ë©´ì—ì„œ ë¦´ë ˆì´ URL ìž…ë ¥

---

## IP ì°¨ë‹¨ ìš°íšŒ

ë™í–‰ë³µê¶Œ ì„œë²„ì—ì„œ IPê°€ ì°¨ë‹¨ëœ ê²½ìš°, Cloudflare Workerë¥¼ ë¦´ë ˆì´ë¡œ ë°°í¬í•˜ì—¬ ìš°íšŒí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

**[IP ì°¨ë‹¨ ìš°íšŒ ìƒì„¸ ê°€ì´ë“œ â†’](RELAY_GUIDE.md)**

ì„¤ì • ì‹œ "IP ì°¨ë‹¨ ìš°íšŒ (ë¦´ë ˆì´ ì„œë²„ ì‚¬ìš©)" ì²´í¬ë°•ìŠ¤ë¥¼ ì„ íƒí•˜ë©´ ë¦´ë ˆì´ URLì„ ìž…ë ¥í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

---

## Options

ì„¤ì • â†’ ê¸°ê¸° ë° ì„œë¹„ìŠ¤ â†’ ë™í–‰ë³µê¶Œ â†’ ì˜µì…˜ì—ì„œ ë³€ê²½ ê°€ëŠ¥:

| ì˜µì…˜ | ì„¤ëª… | ê¸°ë³¸ê°’ |
|------|------|--------|
| `username` | ë™í–‰ë³µê¶Œ ì•„ì´ë”” | (í•„ìˆ˜) |
| `password` | ë™í–‰ë³µê¶Œ ë¹„ë°€ë²ˆí˜¸ | (í•„ìˆ˜) |
| `location_entity` | ìœ„ì¹˜ ì—”í‹°í‹° (ë‚´ ì£¼ë³€ íŒë§¤ì  ê±°ë¦¬ ê³„ì‚°ìš©) | (ì„ íƒ) |
| `use_relay` | IP ì°¨ë‹¨ ìš°íšŒ (ë¦´ë ˆì´ ì„œë²„ ì‚¬ìš©) | False |
| `relay_url` | ë¦´ë ˆì´ ì„œë²„ URL | (ì„ íƒ) |

> ë‹¹ì²¨ê²°ê³¼ ìžë™ ì—…ë°ì´íŠ¸: ë¡œë˜6/45ëŠ” ë§¤ì£¼ í† ìš”ì¼ 21:10, ì—°ê¸ˆë³µê¶Œ720+ëŠ” ë§¤ì£¼ ëª©ìš”ì¼ 19:30ì— ìžë™ í™•ì¸ë©ë‹ˆë‹¤. ê²°ê³¼ê°€ ì•„ì§ ë°˜ì˜ë˜ì§€ ì•Šì€ ê²½ìš° 10ë¶„ ê°„ê²©ìœ¼ë¡œ ìž¬ì‹œë„í•©ë‹ˆë‹¤.

---

## Debug (Logs)

`configuration.yaml`:

```yaml
logger:
  default: info
  logs:
    custom_components.donghang_lottery: debug
```

---

## Troubleshooting

### IP ì°¨ë‹¨ ì‹œ
- ìƒì„¸í•œ ìš°íšŒ ë°©ë²•ì€ [IP ì°¨ë‹¨ ìš°íšŒ ê°€ì´ë“œ](RELAY_GUIDE.md)ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”
- ì„¤ì •ì—ì„œ "IP ì°¨ë‹¨ ìš°íšŒ" ì˜µì…˜ì„ í™œì„±í™”í•˜ê³  ë¦´ë ˆì´ URLì„ ìž…ë ¥í•˜ì„¸ìš”

### 403/429 ì—ëŸ¬ ë°œìƒ ì‹œ
- ì„œí‚· ë¸Œë ˆì´ì»¤ê°€ ìžë™ìœ¼ë¡œ ìž‘ë™í•˜ì—¬ 60~300ì´ˆê°„ ìš”ì²­ì„ ì¤‘ë‹¨í•©ë‹ˆë‹¤
- ìžë™ìœ¼ë¡œ ë³µêµ¬ë˜ë©°, ë¡œê·¸ì—ì„œ ìƒíƒœë¥¼ í™•ì¸í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤

### ë¡œê·¸ì¸ ì‹¤íŒ¨ ì‹œ
- ë™í–‰ë³µê¶Œ ì‚¬ì´íŠ¸ì—ì„œ ì§ì ‘ ë¡œê·¸ì¸í•˜ì—¬ ê³„ì • ìƒíƒœ í™•ì¸
- ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ í›„ í†µí•© ìž¬ì„¤ì •
- ë™í–‰ë³µê¶Œ ì‚¬ì´íŠ¸ ì ê²€ ì‹œê°„ í™•ì¸ (ë§¤ì£¼ ì¼ìš”ì¼ ìƒˆë²½)

### ë‚´ ì£¼ë³€ íŒë§¤ì  ì„¼ì„œê°€ í‘œì‹œë˜ì§€ ì•Šì„ ë•Œ
- ì„¤ì •ì—ì„œ ìœ„ì¹˜ ì—”í‹°í‹°ê°€ ì˜¬ë°”ë¥´ê²Œ ì§€ì •ë˜ì–´ ìžˆëŠ”ì§€ í™•ì¸
- ìœ„ì¹˜ ì—”í‹°í‹°ì— latitude/longitude ì†ì„±ì´ ìžˆëŠ”ì§€ í™•ì¸
- ë‹¹ì²¨ íŒë§¤ì  API ì‘ë‹µì— ë¬¼ë¦¬ ë§¤ìž¥ì´ ì—†ëŠ” ê²½ìš° (ëª¨ë‘ ì˜¨ë¼ì¸ íŒë§¤ì ) ì„¼ì„œê°€ ë¹„ì–´ìžˆì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤

---

## Dependencies

- `beautifulsoup4>=4.13.0` - HTML íŒŒì‹±
- `html5lib>=1.1` - HTML5 íŒŒì„œ
- `pycryptodome>=3.20.0` - RSA/AES ì•”í˜¸í™”

---

## License

MIT License
